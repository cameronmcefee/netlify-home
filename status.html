{% assign incident = site.incidents.first %}

<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Netlify Status</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel='stylesheet' href='//fonts.googleapis.com/css?family=Roboto:100,300,400,500,700'>
    <link rel="stylesheet" href="/css/status.css">

    <script src="/js/vendor/modernizr-2.8.3.min.js"></script>
</head>

<body>

  {% include svg-defs.html %}

  <!-- Site Header -->
  <header class="site-header bb bb--medium inverse" role="banner">
    <div class="content content--wide">
      <!-- Branding: logo & claim -->
      <section class="brand left mt-20 mb-20">
        <a href="/" class="loud">
          <svg class="brand-logo" width="180" height="70">
            <use xlink:href="#netlify-logo" />
          </svg>
        </a>
      </section>
      
      <nav class="top-nav right mt-20 optional">
        <ul class="nav nav--social">
          {% for link in site.social-links %}
          <li>
            <a href="{{link[1]}}" class="icon-link--square icon-link--{{link[0]}}">
              <svg width="16" height="16" class="icon-{{link[0]}}--square">
                <use xlink:href="#icon-{{link[0]}}"/>
              </svg>
            </a>
          </li>
          {% endfor %}
        </ul>
      </nav>
    </div>
  </header>
  <!-- end Site Header -->

  <!-- Page Body -->
  <main class="inverse bg-dark-muted-cover bb bb--large">
    
    <header class="content text-center">
    {% if incident.resolved %}
      <h1 class="mega mt-110">
        All Systems Operational
      </h1>
      <p class="epsilon muted">
        If you are experiencing any issues please <a href="#">open a support ticket<svg class="append" width="16" height="16"><use xlink:href="#icon-link" /></svg></a>
      </p>
    {% else %}
      <h1 class="mega mt-110">
        {{ incident.title }}
      </h1>
      <p class="epsilon">
        {{ incident.description | markdownify }}
      </p>
    {% endif %}
    </header>

    <div class="l-wrap mb-140">
      <div class="l-wrap-inner l-wrap-inner--narrow l-wrap-inner--main-left">

        <div class="l-aside l-aside--right">
          <section class="mt-50">
            <div class="blurb-hd">
              <h2 class="blurb-title left">Services</h2>
            </div>
            <div class="blurb-bd">
              <ul>
                {% for service in site.services %}
                <li>
                  <svg class="highlight prepend" width="16" height="16"><use xlink:href="#icon-ok" /></svg>{{service}}
                </li>
                {% endfor %}
              </ul>
            </div>
          </section>
        </div>

        <div class="l-main l-main--left">
          <section class="mt-50">
            <header class="blurb-hd">
              <h2 class="blurb-title left">Status History</h1>
              <form class="blurb-meta right highlight js">
                {% assign day   = site.time | date: '%d' %}
                {% assign month = site.time | date: '%m' %}
                {% assign year  = site.time | date: '%Y' %}
                {% assign id    = 0 %}
                <select>
                  <option selected>This month</option>
                  {% if month != "01" %}
                  <option>All {{year}}</option>
                  {% endif %}
                  <option>All {{year | minus: 1}}</option>
                </select>
              </form>
            </header>
            <div class="blurb-bd">
              <ul>
              {% for d in (1..day) reversed %}
                {% capture date_string %}{{ year }}-{{ month }}-{% if d < 10 %}0{% endif %}{{ d }}{% endcapture %}
                {% assign date = date_string | parse_date %}
                {% assign incidents = site.incidents | where: "date", date %}
                
                <li class="mt-5">
                {% if incidents == empty %}
                
                  <div class="small muted">
                    <svg class="prepend" width="16" height="16"><use xlink:href="#icon-ok" /></svg>
                    <time>{{ date_string }}</time>
                  </div>
                  
                {% else %}
                  
                  {% for incident in incidents %}
                    
                    {% assign id = id | plus: 1 %}
                    <article id="incident-{{ id }}" class="clearfix">
                      <div class="small mt-25">
                        <svg class="prepend" width="16" height="16"><use xlink:href="#icon-ko" /></svg>
                        <time>{{ incident.date | date: '%Y-%m-%d' }}</time>
                      </div>
                      <div class="left ml-30">
                        <h3 class="epsilon">{{ incident.title }}</h3>
                        {{ incident.description | markdownify }}
                        
                        {% if incident.details != empty %}
                        <div class="details" id="incident-details-{{ id }}">
                          <p class="details-more">
                            <a class="small" href="#incident-details-{{ id }}">
                              Show full details
                              <svg width="16" height="16" class="append"><use xlink:href="#icon-more" /></svg>
                            </a>
                          </p>
                          <div class="details-bd">
                            {{ incident.details | markdownify }}
                            <p>
                              <a class="small" href="#incident-{{ id }}">
                                Hide full details
                                <svg width="16" height="16" class="append"><use xlink:href="#icon-less" /></svg>
                              </a>
                            </p>
                          </div>
                        </div>
                        {% endif %}
                        
                      </div>
                    </article>
                  {% endfor %}
                </li>
                {% endif %}
              {% endfor %}
               
              </ul>
            </div>
          </section>
        </div>
      </div>
    </div>
  </main>
  <!-- end Page Body -->
  
  {% include site-footer.html %}
</body>
</html>